<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlanPilot</title>
    <meta name="description" content="Plan your perfect getaway with AI-powered trip planning">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Theme Colors -->
    <meta name="theme-color" content="#1E88E5">
    <meta name="msapplication-TileColor" content="#1E88E5">
    
    <!-- iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="PlanPilot">
    <link rel="apple-touch-icon" href="/planpilot.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/planpilot.png">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- PlanPilot CSS -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/map.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- Hamburger Menu Button -->
    <button class="hamburger-menu" id="hamburgerBtn" onclick="toggleSidebar()" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
    </button>
    
    <!-- Sidebar Backdrop for Mobile -->
    <div class="sidebar-backdrop" id="sidebarBackdrop" onclick="closeSidebar()"></div>
    
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-fixed-header">
            <div class="sidebar-header">
                <div class="sidebar-header-logo" id="logoContainer">
                    <img id="logoImage" src="planpilot.png" alt="PlanPilot Logo" onerror="showLogoFallback()">
                </div>
                <h1>
                    <span>PlanPilot</span>
                    <button class="info-btn" onclick="openInfoModal()" title="About PlanPilot">i</button>
                </h1>
                <p>Plan your perfect getaway</p>
            </div>
            
            <div class="sidebar-action-buttons">
                <button class="btn btn-primary" onclick="openPlanningModal()" style="margin-bottom: 10px;">
                    üöÄ Start Planning
                </button>
                
                <button class="btn btn-secondary" onclick="toggleTripSummary()" style="margin-bottom: 15px;">
                    üìã Trip Itinerary
                </button>

                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-secondary" onclick="exportData()" style="flex: 1;">üíæ Save</button>
                    <button class="btn btn-secondary" onclick="shareTrip()" style="flex: 1;">üì§ Share</button>
                    <button class="btn btn-secondary" onclick="importData()" style="flex: 1;">üìÇ Load</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Map Container -->
    <div id="map"></div>

    <!-- Trip Summary Panel -->
    <div id="trip-summary-container" class="trip-summary-container">
        <div class="trip-summary-header">
            <h3><span id="tripTitleDisplay">üó∫Ô∏è Trip Itinerary</span></h3>
            <div class="trip-summary-header-actions">
                <button id="trip-summary-edit-btn" class="trip-summary-edit-btn" onclick="toggleEditMode()" title="Add Location">
                    <span id="editModeIcon">+</span>
                </button>
                <button id="trip-summary-delete-btn" class="trip-summary-edit-btn" onclick="toggleDeleteMode()" title="Delete Mode">
                    <span id="deleteModeIcon">üóëÔ∏è</span>
                </button>
                <button id="trip-summary-close" class="trip-summary-close" onclick="toggleTripSummary()">‚úï</button>
            </div>
        </div>
        <div id="editTripContainer" class="trip-summary-edit-container" style="display: none;">
            <div class="control-group">
                <label for="tripTitle">Trip Title</label>
                <input type="text" id="tripTitle" placeholder="e.g., Sri Lanka Honeymoon" oninput="updateTripTitle()">
                <small>This title will display in the header above</small>
            </div>

            <div id="connectionMode" class="connection-mode" style="display: none;">
                <p><strong>Connection Mode Active</strong><br>Click on two Key Locations to connect them with a line.</p>
                <button class="btn btn-secondary" onclick="cancelConnectionMode()">Cancel</button>
            </div>

            <div class="control-group">
                <label for="locationType">Location Type</label>
                <select id="locationType">
                    <option value="key-location">Key Location</option>
                    <option value="accommodation">Accommodation</option>
                    <option value="attraction">Attraction</option>
                </select>
            </div>

            <div class="control-group">
                <label for="locationName">Name</label>
                <input type="text" id="locationName" placeholder="e.g., Eiffel Tower">
            </div>

            <div class="control-group">
                <label for="locationDescription">Description (Optional)</label>
                <textarea id="locationDescription" placeholder="Add notes about this location..."></textarea>
            </div>

            <div class="control-group">
                <label for="locationPrice">Price (Optional)</label>
                <input type="text" id="locationPrice" placeholder="e.g., $150/night or ‚Ç¨25 entry">
            </div>

            <div class="control-group">
                <label for="locationLink">Link (Optional)</label>
                <input type="url" id="locationLink" placeholder="https://example.com/booking">
                <small>Website, booking link, or reference URL</small>
            </div>

            <div class="control-group">
                <label for="locationCoords">Coordinates</label>
                <input type="text" id="locationCoords" placeholder="Click on map or enter lat, lng" readonly>
                <small>Click anywhere on the map to set coordinates</small>
            </div>

            <div class="trip-summary-edit-actions">
                <button class="btn btn-primary" onclick="addLocation()">Add to Map</button>
                <button class="btn btn-secondary" onclick="startConnectionMode()">Connect Key Locations</button>
            </div>
        </div>
        <div class="trip-summary-body">
            <!-- Content generated dynamically by trip-summary.js -->
        </div>
    </div>

    <!-- Map Controls Toggle Button -->
    <button id="map-controls-toggle-btn" class="map-controls-toggle-btn" onclick="toggleMapControls()">
        üó∫Ô∏è Map Controls
    </button>

    <!-- Map Controls Panel -->
    <div id="map-controls-panel" class="map-controls-panel">
        <div class="map-controls-header">
            <h4>üó∫Ô∏è Map Controls</h4>
            <button class="map-controls-close" onclick="toggleMapControls()">‚úï</button>
        </div>
        
        <div class="map-controls-section">
            <h5>Map Style</h5>
            <div class="map-style-options">
                <div class="map-style-option" onclick="changeMapStyle('light')">
                    <input type="radio" name="mapStyle" id="styleLight" value="light" checked>
                    <label for="styleLight">‚òÄÔ∏è Light</label>
                </div>
                <div class="map-style-option" onclick="changeMapStyle('street')">
                    <input type="radio" name="mapStyle" id="styleStreet" value="street">
                    <label for="styleStreet">üó∫Ô∏è Street</label>
                </div>
                <div class="map-style-option" onclick="changeMapStyle('satellite')">
                    <input type="radio" name="mapStyle" id="styleSatellite" value="satellite">
                    <label for="styleSatellite">üõ∞Ô∏è Satellite</label>
                </div>
                <div class="map-style-option" onclick="changeMapStyle('topo')">
                    <input type="radio" name="mapStyle" id="styleTopo" value="topo">
                    <label for="styleTopo">‚õ∞Ô∏è Topographic</label>
                </div>
                <div class="map-style-option" onclick="changeMapStyle('dark')">
                    <input type="radio" name="mapStyle" id="styleDark" value="dark">
                    <label for="styleDark">üåô Dark</label>
                </div>
            </div>
        </div>

        <div class="map-controls-section">
            <h5>üîç Show/Hide Locations</h5>
            <div class="filter-item" onclick="toggleFilter('filterKeyLocation')">
                <input type="checkbox" id="filterKeyLocation" checked onchange="applyFilters()" onclick="event.stopPropagation()">
                <div class="legend-color key-location">üìç</div>
                <label for="filterKeyLocation">
                    <span>Key Locations</span>
                    <span class="filter-item-count" id="countKeyLocation">0</span>
                </label>
            </div>
            <div class="filter-item" onclick="toggleFilter('filterAccommodation')">
                <input type="checkbox" id="filterAccommodation" checked onchange="applyFilters()" onclick="event.stopPropagation()">
                <div class="legend-color accommodation">üè®</div>
                <label for="filterAccommodation">
                    <span>Accommodation</span>
                    <span class="filter-item-count" id="countAccommodation">0</span>
                </label>
            </div>
            <div class="filter-item" onclick="toggleFilter('filterAttraction')">
                <input type="checkbox" id="filterAttraction" checked onchange="applyFilters()" onclick="event.stopPropagation()">
                <div class="legend-color attraction">‚≠ê</div>
                <label for="filterAttraction">
                    <span>Attractions</span>
                    <span class="filter-item-count" id="countAttraction">0</span>
                </label>
            </div>
        </div>
    </div>

    <!-- Import Modal -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìÇ Load Data</h2>
            </div>
            <div class="modal-body">
                <div class="control-group">
                    <label>Option 1: Select Trip File</label>
                    <input type="file" id="importFile" accept=".trip,.json" style="margin-bottom: 10px;" onchange="clearImportText()">
                    <small>Choose a .trip or .json file from your computer</small>
                </div>
                <div style="text-align: center; margin: 15px 0; color: var(--text-muted);">‚Äî OR ‚Äî</div>
                <div class="control-group">
                    <label for="importText">Option 2: Paste Trip Data</label>
                    <textarea id="importText" style="min-height: 150px;" oninput="clearImportFile()"></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" onclick="processImport()">Load</button>
                <button class="btn btn-secondary" onclick="closeImportModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2 id="confirmTitle">‚ö†Ô∏è Confirm Action</h2>
            </div>
            <div class="modal-body">
                <p id="confirmMessage" style="font-size: 14px; color: var(--text-primary); line-height: 1.6;"></p>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" id="confirmYes">Yes, Continue</button>
                <button class="btn btn-secondary" id="confirmNo">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div id="alertModal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2 id="alertTitle">‚ÑπÔ∏è Information</h2>
            </div>
            <div class="modal-body">
                <p id="alertMessage" style="font-size: 14px; color: var(--text-primary); line-height: 1.6; white-space: pre-line;"></p>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" id="alertOk">OK</button>
            </div>
        </div>
    </div>

    <!-- Planning Modal -->
    <div id="planningModal" class="modal">
        <div class="modal-content" style="max-width: 550px;">
            <div class="modal-header">
                <h2>üöÄ Plan Your Trip</h2>
            </div>
            <div class="modal-body">
                <p style="font-size: 14px; color: #555; margin-bottom: 20px;">
                    Tell us about your trip and our AI will research and generate a complete itinerary for you!
                </p>
                
                <form id="tripPlanningForm" onsubmit="handlePlanningFormSubmit(event)">
                    <div class="control-group">
                        <label for="planDestination">Destination *</label>
                        <input type="text" id="planDestination" required placeholder="e.g., Paris, France">
                    </div>
                    
                    <div class="control-group">
                        <label for="planDuration">Trip Duration *</label>
                        <input type="text" id="planDuration" required placeholder="e.g., 5 days, 1 week">
                    </div>
                    
                    <div class="control-group">
                        <label for="planBudget">Budget Level</label>
                        <select id="planBudget">
                            <option value="">Select budget (optional)</option>
                            <option value="budget">Budget-friendly</option>
                            <option value="mid-range">Mid-range</option>
                            <option value="luxury">Luxury</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="planResponseMode">AI Response Mode</label>
                        <select id="planResponseMode">
                            <option value="flash">‚ö° Quick & Light (5-15 seconds, fewer options)</option>
                            <option value="pro">üéØ Slow & Detailed (15-30 seconds, more options)</option>
                        </select>
                        <small style="font-style: italic;">
                            Quick mode is faster and cheaper. Detailed mode searches more thoroughly and provides more accommodation and attraction options.
                        </small>
                    </div>
                    
                    <div class="control-group">
                        <label for="planInterests">Interests (comma-separated)</label>
                        <input type="text" id="planInterests" placeholder="e.g., art, food, history, beaches">
                    </div>
                    
                    <div class="control-group">
                        <label for="planMustVisit">Must-Visit Locations</label>
                        <textarea id="planMustVisit" rows="2" placeholder="Specific places you want to include (optional)"></textarea>
                    </div>
                    
                    <div class="note" style="margin-top: 15px; font-size: 12px;">
                        <strong>‚ú® Note:</strong> The AI will research accommodations, attractions, prices, and coordinates to create your complete trip plan.
                    </div>
                </form>
            </div>
            <div class="modal-actions">
                <button type="submit" form="tripPlanningForm" class="btn btn-primary">
                    ‚ú® Generate Trip Plan
                </button>
                <button class="btn btn-secondary" onclick="closePlanningModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <h3 id="loadingTitle">Generating Your Trip Plan...</h3>
            <p id="loadingMessage">Researching destinations and gathering information</p>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
        </div>
    </div>

    <!-- Info Modal -->
    <div id="infoModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>üó∫Ô∏è About PlanPilot</h2>
            </div>
            <div class="modal-body">
                <div class="info-content">
                    <!-- Introduction Section -->
                    <div style="background: linear-gradient(135deg, var(--primary-color) 0%, #0a7bb8 100%); color: white; padding: 20px; border-radius: 8px; margin-bottom: 25px; text-align: center;">
                        <h3 style="margin: 0 0 10px 0; color: white; font-size: 20px;">What is PlanPilot?</h3>
                        <p style="margin: 0; font-size: 14px; line-height: 1.6;">An AI-powered trip planning application that helps you create, visualise, and manage your travel itineraries on an interactive map.</p>
                    </div>

                    <!-- Navigation Tabs -->
                    <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center;">
                        <button class="info-tab-btn active" onclick="showInfoTab('features')" style="flex: 1; min-width: 120px; padding: 10px 15px; border: 2px solid var(--primary-color); background: var(--primary-color); color: white; border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s;">Features</button>
                        <button class="info-tab-btn" onclick="showInfoTab('howto')" style="flex: 1; min-width: 120px; padding: 10px 15px; border: 2px solid var(--border-color); background: white; color: var(--text-primary); border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s;">How to Use</button>
                        <button class="info-tab-btn" onclick="showInfoTab('tips')" style="flex: 1; min-width: 120px; padding: 10px 15px; border: 2px solid var(--border-color); background: white; color: var(--text-primary); border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s;">Tips & Tricks</button>
                    </div>

                    <!-- Features Tab -->
                    <div id="info-tab-features" class="info-tab-content">
                        <div style="display: grid; gap: 20px;">
                            <!-- Feature Card 1 -->
                            <div style="background: var(--bg-secondary); padding: 18px; border-radius: 8px; border-left: 4px solid #9b59b6;">
                                <h4 style="margin: 0 0 10px 0; color: var(--primary-color); display: flex; align-items: center; gap: 8px;">
                                    <span style="font-size: 20px;">ü§ñ</span> AI Trip Generation
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                                    <li>Generate complete trip plans instantly with AI</li>
                                    <li>Real accommodations with prices and booking links</li>
                                    <li>Choose Quick or Detailed generation modes</li>
                                    <li>Automatic GPS coordinates and map visualisation</li>
                                </ul>
                            </div>

                            <!-- Feature Card 2 -->
                            <div style="background: var(--bg-secondary); padding: 18px; border-radius: 8px; border-left: 4px solid #3498db;">
                                <h4 style="margin: 0 0 10px 0; color: var(--primary-color); display: flex; align-items: center; gap: 8px;">
                                    <span style="font-size: 20px;">üó∫Ô∏è</span> Interactive Map
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                                    <li><strong style="color: #9b59b6;">Purple markers (üìç)</strong> ‚Äì Key destinations</li>
                                    <li><strong style="color: #27ae60;">Green markers (üè®)</strong> ‚Äì Accommodations</li>
                                    <li><strong style="color: #e74c3c;">Red markers (‚≠ê)</strong> ‚Äì Attractions</li>
                                    <li>Multiple map styles (Street, Satellite, Dark mode)</li>
                                </ul>
                            </div>

                            <!-- Feature Card 3 -->
                            <div style="background: var(--bg-secondary); padding: 18px; border-radius: 8px; border-left: 4px solid #e67e22;">
                                <h4 style="margin: 0 0 10px 0; color: var(--primary-color); display: flex; align-items: center; gap: 8px;">
                                    <span style="font-size: 20px;">üìã</span> Trip Itinerary
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                                    <li>Timeline view of your complete journey</li>
                                    <li>Trip statistics and duration calculations</li>
                                    <li>Drag and drop to reorder locations</li>
                                    <li>Delete or modify items directly</li>
                                </ul>
                            </div>

                            <!-- Feature Card 4 -->
                            <div style="background: var(--bg-secondary); padding: 18px; border-radius: 8px; border-left: 4px solid #27ae60;">
                                <h4 style="margin: 0 0 10px 0; color: var(--primary-color); display: flex; align-items: center; gap: 8px;">
                                    <span style="font-size: 20px;">üíæ</span> Save & Share
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                                    <li>Share trips with friends and family (mobile)</li>
                                    <li>Export trips as .trip files for backup</li>
                                    <li>Import and share trips with others</li>
                                    <li>Automatic browser storage (no account needed)</li>
                                    <li>Data persists across sessions</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- How To Use Tab -->
                    <div id="info-tab-howto" class="info-tab-content" style="display: none;">
                        <div style="display: grid; gap: 20px;">
                            <!-- Method 1 -->
                            <div style="background: linear-gradient(to right, #f8f9fa, #ffffff); padding: 20px; border-radius: 8px; border: 2px solid var(--border-color);">
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                    <span style="background: var(--primary-color); color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">1</span>
                                    <h4 style="margin: 0; color: var(--primary-color);">AI-Generated Trip (Easiest)</h4>
                                </div>
                                <ol style="margin: 0; padding-left: 20px; line-height: 1.8;">
                                    <li>Click <strong>"üöÄ Start Planning"</strong></li>
                                    <li>Enter destination, duration, and budget level</li>
                                    <li>Select your interests and must-visit places</li>
                                    <li>Click <strong>"Generate Trip Plan"</strong></li>
                                    <li>Your complete itinerary appears on the map!</li>
                                </ol>
                            </div>

                            <!-- Method 2 -->
                            <div style="background: linear-gradient(to right, #f8f9fa, #ffffff); padding: 20px; border-radius: 8px; border: 2px solid var(--border-color);">
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                    <span style="background: var(--primary-color); color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">2</span>
                                    <h4 style="margin: 0; color: var(--primary-color);">Manual Trip Planning</h4>
                                </div>
                                <ol style="margin: 0; padding-left: 20px; line-height: 1.8;">
                                    <li>Click anywhere on the map to set coordinates</li>
                                    <li>Select location type in the sidebar form</li>
                                    <li>Fill in name, description, price, and link</li>
                                    <li>Click <strong>"Add Location"</strong></li>
                                    <li>Use "Connect Locations" to draw travel routes</li>
                                </ol>
                            </div>

                            <!-- Method 3 -->
                            <div style="background: linear-gradient(to right, #f8f9fa, #ffffff); padding: 20px; border-radius: 8px; border: 2px solid var(--border-color);">
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                    <span style="background: var(--primary-color); color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">3</span>
                                    <h4 style="margin: 0; color: var(--primary-color);">Import Existing Trip</h4>
                                </div>
                                <ol style="margin: 0; padding-left: 20px; line-height: 1.8;">
                                    <li>Click <strong>"üìÇ Load"</strong></li>
                                    <li>Upload a .trip file or paste trip data</li>
                                    <li>Click <strong>"Import Data"</strong></li>
                                    <li>Your trip loads instantly!</li>
                                </ol>
                            </div>

                            <!-- Quick Actions -->
                            <div style="background: #e3f2fd; padding: 18px; border-radius: 8px; border-left: 4px solid #2196f3;">
                                <h4 style="margin: 0 0 12px 0; color: #1976d2;">‚ö° Quick Actions</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; font-size: 13px; line-height: 1.6;">
                                    <div><strong>View details:</strong> Click any marker</div>
                                    <div><strong>Edit title:</strong> Click trip name on map</div>
                                    <div><strong>Filter view:</strong> Use type filter buttons</div>
                                    <div><strong>Delete item:</strong> Use delete buttons</div>
                                    <div><strong>Reorder:</strong> Drag in itinerary view</div>
                                    <div><strong>Clear all:</strong> Bottom of sidebar</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tips Tab -->
                    <div id="info-tab-tips" class="info-tab-content" style="display: none;">
                        <div style="display: grid; gap: 15px;">
                            <div style="display: flex; gap: 12px; padding: 15px; background: var(--bg-secondary); border-radius: 8px;">
                                <span style="font-size: 24px; flex-shrink: 0;">üí°</span>
                                <div>
                                    <strong style="color: var(--primary-color);">Start with AI, then personalise</strong>
                                    <p style="margin: 5px 0 0 0; color: var(--text-secondary); font-size: 14px;">Generate a base itinerary with AI, then manually add, remove, or adjust locations to match your exact preferences.</p>
                                </div>
                            </div>

                            <div style="display: flex; gap: 12px; padding: 15px; background: var(--bg-secondary); border-radius: 8px;">
                                <span style="font-size: 24px; flex-shrink: 0;">üéØ</span>
                                <div>
                                    <strong style="color: var(--primary-color);">Use the itinerary view</strong>
                                    <p style="margin: 5px 0 0 0; color: var(--text-secondary); font-size: 14px;">Get a timeline overview of your journey with trip statistics, nearby accommodations, and attractions organised by distance.</p>
                                </div>
                            </div>

                            <div style="display: flex; gap: 12px; padding: 15px; background: var(--bg-secondary); border-radius: 8px;">
                                <span style="font-size: 24px; flex-shrink: 0;">üîó</span>
                                <div>
                                    <strong style="color: var(--primary-color);">Navigate quickly</strong>
                                    <p style="margin: 5px 0 0 0; color: var(--text-secondary); font-size: 14px;">Click location names in the itinerary to instantly pan the map to that spot and open its marker.</p>
                                </div>
                            </div>

                            <div style="display: flex; gap: 12px; padding: 15px; background: var(--bg-secondary); border-radius: 8px;">
                                <span style="font-size: 24px; flex-shrink: 0;">üíæ</span>
                                <div>
                                    <strong style="color: var(--primary-color);">Export regularly</strong>
                                    <p style="margin: 5px 0 0 0; color: var(--text-secondary); font-size: 14px;">Back up your trip or share it with travel companions by exporting as a .trip file.</p>
                                </div>
                            </div>

                            <div style="display: flex; gap: 12px; padding: 15px; background: var(--bg-secondary); border-radius: 8px;">
                                <span style="font-size: 24px; flex-shrink: 0;">üó∫Ô∏è</span>
                                <div>
                                    <strong style="color: var(--primary-color);">Try different map styles</strong>
                                    <p style="margin: 5px 0 0 0; color: var(--text-secondary); font-size: 14px;">Switch between Street, Satellite, Topographic, and Dark mode to see your trip in different visual contexts.</p>
                                </div>
                            </div>

                            <div style="display: flex; gap: 12px; padding: 15px; background: var(--bg-secondary); border-radius: 8px;">
                                <span style="font-size: 24px; flex-shrink: 0;">üìù</span>
                                <div>
                                    <strong style="color: var(--primary-color);">Add detailed descriptions</strong>
                                    <p style="margin: 5px 0 0 0; color: var(--text-secondary); font-size: 14px;">Include notes about why you chose each place, opening hours, or special requirements to help you remember later.</p>
                                </div>
                            </div>

                            <div style="display: flex; gap: 12px; padding: 15px; background: var(--bg-secondary); border-radius: 8px;">
                                <span style="font-size: 24px; flex-shrink: 0;">üé®</span>
                                <div>
                                    <strong style="color: var(--primary-color);">Automatic associations</strong>
                                    <p style="margin: 5px 0 0 0; color: var(--text-secondary); font-size: 14px;">Each accommodation and attraction is automatically linked to its nearest key location in the itinerary view.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" onclick="closeInfoModal()">Got it!</button>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality for info modal
        function showInfoTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.info-tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.info-tab-btn').forEach(btn => {
                btn.style.background = 'white';
                btn.style.color = 'var(--text-primary)';
                btn.style.borderColor = 'var(--border-color)';
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById('info-tab-' + tabName).style.display = 'block';
            
            // Highlight active button
            event.target.style.background = 'var(--primary-color)';
            event.target.style.color = 'white';
            event.target.style.borderColor = 'var(--primary-color)';
            event.target.classList.add('active');
        }
    </script>

    <!-- Location Details Modal -->
    <div id="locationDetailsModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 id="locationDetailsTitle">üìç Location Details</h2>
            </div>
            <div class="modal-body">
                <div id="locationDetailsContent">
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" onclick="closeLocationDetailsModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- PlanPilot JS (ES6 Module) -->
    <script type="module" src="js/app.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        // Register service worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('ServiceWorker registered:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
